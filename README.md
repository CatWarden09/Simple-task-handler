# Simple Task Handler

## Оглавление
- [Стек](#стек)
- [Совместимость](#совместимость)
- [Первый запуск](#первый-запуск)
- [Настройка папок](#настройка-папок)
- [Список команд](#список-команд)
- [Загрузить программу](#загрузить-программу)

## Стек
- Python 3.10+
- psutil
- os
- sys
- subprocess
- pywinauto
- Python-dotenv

## Краткое описание
Simple Task Handler - это программа для управления копиями других программ, расположенных в одной и той же родительской директории.

**⚠️ВНИМАНИЕ!⚠️**

Программа является учебным/демонстрационным проектом - использовать только при полном понимании логики работы программы и на свой страх и риск.

Программа была протестирована **только на Telegram (Windows 10)**.

Во время разработки программы изучались и были реализованы:

- Массовая работа с процессами: запуск, завершение, фильтрация по папке и exe-файлу, поддержка диапазонов и исключений (skip-mark).
- Управление окнами GUI через pywinauto с обработкой ошибок и таймаутов.
- Организация конфигурации ПО через .env для сохранения данных между сессиями.
- Архитектура консольного ПО на основе меню и команд с вложенными циклами.
- Проверка корректности пользовательского ввода и обработка ошибок (ValueError, FileNotFound, AccessDenied и т.д.).
- Сортировка и обработка данных для аккуратного отображения в консоли.
- Работа с файловой системой через модуль os (перебор папок, динамическое построение путей)

## Совместимость
Только Windows, не тестировалось на других ОС

## Первый запуск
При первом запуске необходимо указать:
- путь к папке, в которой расположены копии программы - в формате "С:\Folder1\Folder2\Folder3\..." (без кавычек);
- метку для папок, которые нужно исключить из логики запуска/завершения и работать с ними через отдельные команды (например, "(skip)" - без кавычек.)
  **Важно!** - метка в названии исключаемых папок должна полностью совпадать с указанной для Task Handler, без каких-либо лишних символов.
  Например, если папки называются 1, 2, 3, 4, 5... , то итоговое название исключаемой папки должно быть таким: 1(skip), 2(skip), 3, 4, 5(skip) и так далее...
- название .exe-файла программы, с которой нужно работать (например, "Telegram.exe" - без кавычек);

После этого программа автоматически создаст в своей директории .env-файл с перечисленными данными и будет использовать их для работы. При необходимости .env-файл можно изменить вручную.

## Настройка папок

Логика работы программы рассчитана на следующий вид папок:

-> Основная папка (может быть названа как угодно)

->-> Дочерние подпапки, в которых расположен .exe нужной программы (необходимо называть только числовыми индексами)

Для удобства и безопасности нужно располагать в основной папке только те дочерние папки, в которых лежат "рабочие" версии программы. Например, если вы используете одну из копий Telegram в личных целях, её лучше держать в отдельной папке вне основной (например, на уровень выше).

Пример иерархии папок:

-> MainFolder

->-> 1

->->-> Program.exe

->-> 2

->->-> Program.exe

->-> 3

->->-> Program.exe

И так далее...

## Список команд
   ```markdown
   1. Запустить все процессы. ВНИМАНИЕ! УЧИТЫВАЙТЕ ХАРАКТЕРИСТИКИ СВОЕГО ПК!
   2. Завершить все процессы
   3. Запустить процессы выборочно
   4. Завершить процессы выборочно
   5. Показать список процессов
   6. Закрыть все активные окна
   7. Запустить выбранный процесс
   8. Завершить выбранный процесс
   9. Запустить исключенные процессы
   10. Завершить исключенные процессы
   11. Посчитать исключенные папки
   0. Выход
```
### Команда "1. Запустить все процессы"
Запускает все программы под .exe, указанным в коде, и расположенные по указанному пользователем пути в подпапках с цифровым индексом (см.[ **Настройка папок**](#настройка-папок)). Запуск производится одновременно, поэтому команда не рекомендуется к использованию на слабых ПК.

### Команда "2. Завершить все процессы"
Завершает все запущенные копии программы под .exe, указанным в коде, и расположенные по указанному пользователем пути в подпапках с цифровым индексом (в том числе с меткой для исключения)

### Команда "3. Запустить процессы выборочно"
Аналогично с командой №1, но запускает программы лишь из указанного пользователем диапазона - при выборе команды сначала указывается число начала диапазона, затем - конца.

Диапазон учитывает только подпапки с цифровым индексом (без сторонних символов) - например, если пользователю нужно запустить лишь копии программы из папок с 1ой по 10ую, то в программе нужно указать начало диапазона как **1**, а конец - как **10**.

При этом, если в названии подпапки есть какое-то слово или обозначение - например, **2(Don't use)** - то программа проигнорирует эту подпапку.

Диапазон может состоять из одного значения. Например, если начало диапазона 5 и конец - тоже 5, то запустится только программа из подпапки №5.

### Команда "4. Завершить процессы выборочно"
Аналогично с командой №3, но для завершения процессов.

### Команда "5. Показать список процессов"
Отображает все запущенные процессы с сортировкой числовых индексов подпапок по возрастанию, а также показывает общее количество запущенных процессов

### Команда "6. Закрыть все активные окна"
Закрывает все активные окна для всех запущенных копий программы и убирает их из панели задач - при этом копии программы остаются в трее, и их можно открыть повторно (**Важно!** Сейчас в коде захардкожены классы окна только для Telegram, при необходимости определить класс окна можно при помощи отдельных приложений)

### Команда "7. Запустить выбранный процесс"
Запускает один процесс под указанным номером.

### Команда "8. Завершить выбранный процесс"
Аналогично с командой №7, но для завершения процесса

### Команда "9. Запустить исключенные процессы"
Запускает все процессы с меткой для исключения в названии папки (см. [**Первый запуск**](#первый-запуск))

### Команда "10. Завершить исключенные процессы"
Аналогично с командой №9, но для завершения процессов

### Команда "11. Посчитать исключенные папки"
Выводит количество всех папок с меткой для исключения


## Загрузить программу
[ССЫЛКА](https://github.com/CatWarden09/Simple-task-handler/releases)
